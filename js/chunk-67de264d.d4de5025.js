(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67de264d"],{"5fb23":function(t,e,s){"use strict";var i=s("aaf8"),a=s.n(i);a.a},"6cf3":function(t,e,s){"use strict";var i=s("e6d0"),a=s.n(i);a.a},a0c0:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"banner",style:t.cover},[s("h1",{staticClass:"banner-title"},[t._v("说说")])]),s("v-card",{staticClass:"blog-container"},[s("div",{staticClass:"talk-wrapper"},[s("div",{staticClass:"user-info-wrapper"},[s("v-avatar",{staticClass:"user-avatar",attrs:{size:"36"}},[s("img",{attrs:{src:t.talkInfo.avatar}})]),s("div",{staticClass:"user-detail-wrapper"},[s("div",{staticClass:"user-nickname"},[t._v(" "+t._s(t.talkInfo.nickname)+" "),s("v-icon",{staticClass:"user-sign",attrs:{size:"20",color:"#ffa51e"}},[t._v(" mdi-check-decagram ")])],1),s("div",{staticClass:"time"},[t._v(t._s(t._f("time")(t.talkInfo.createTime)))]),s("div",{staticClass:"talk-content",domProps:{innerHTML:t._s(t.talkInfo.content)}}),t.talkInfo.imgList?s("v-row",{staticClass:"talk-images"},t._l(t.talkInfo.imgList,(function(e,i){return s("v-col",{key:i,attrs:{md:4,cols:6}},[s("v-img",{staticClass:"images-items",attrs:{src:e,"aspect-ratio":"1","max-height":"200"},on:{click:function(s){return t.previewImg(e)}}})],1)})),1):t._e(),s("div",{staticClass:"talk-operation"},[s("div",{staticClass:"talk-operation-item"},[s("v-icon",{staticClass:"like-btn",attrs:{size:"16",color:t.isLike(t.talkInfo.id)},on:{click:function(e){return e.preventDefault(),t.like(t.talkInfo)}}},[t._v(" mdi-thumb-up ")]),s("div",{staticClass:"operation-count"},[t._v(" "+t._s(null==t.talkInfo.likeCount?0:t.talkInfo.likeCount)+" ")])],1),s("div",{staticClass:"talk-operation-item"},[s("v-icon",{attrs:{size:"16",color:"#999"}},[t._v("mdi-chat")]),s("div",{staticClass:"operation-count"},[t._v(" "+t._s(null==t.commentCount?0:t.commentCount)+" ")])],1)])],1)],1)]),s("Comment",{attrs:{type:t.commentType},on:{getCommentCount:t.getCommentCount}})],1)],1)},a=[],n=(s("4160"),s("c975"),s("159b"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),s("div",{staticClass:"comment-wrapper"},[s("div",{staticStyle:{display:"flex",width:"100%"}},[s("v-avatar",{attrs:{size:"36"}},[this.$store.state.avatar?s("img",{attrs:{src:this.$store.state.avatar}}):s("img",{attrs:{src:this.$store.state.blogInfo.websiteConfig.touristAvatar}})]),s("div",{staticClass:"ml-3",staticStyle:{width:"100%"}},[s("div",{staticClass:"comment-input"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],staticClass:"comment-textarea",attrs:{placeholder:"留下点什么吧...","auto-grow":"",dense:""},domProps:{value:t.commentContent},on:{input:function(e){e.target.composing||(t.commentContent=e.target.value)}}})]),s("div",{staticClass:"emoji-container"},[s("span",{class:t.chooseEmoji?"emoji-btn-active":"emoji-btn",on:{click:function(e){t.chooseEmoji=!t.chooseEmoji}}},[s("i",{staticClass:"iconfont iconbiaoqing"})]),s("button",{staticClass:"upload-btn v-comment-btn",staticStyle:{"margin-left":"auto"},on:{click:t.insertComment}},[t._v(" 提交 ")])]),s("emoji",{attrs:{chooseEmoji:t.chooseEmoji},on:{addEmoji:t.addEmoji}})],1)],1)]),t.count>0&&t.reFresh?s("div",[t._l(t.commentList,(function(e,i){return s("div",{key:e.id,staticClass:"comment-wrapper"},[s("v-avatar",{staticClass:"comment-avatar",attrs:{size:"40"}},[s("img",{attrs:{src:e.avatar}})]),s("div",{staticClass:"comment-meta"},[s("div",{staticClass:"comment-user"},[e.webSite?s("a",{attrs:{href:e.webSite,target:"_blank"}},[t._v(" "+t._s(e.nickname)+" ")]):s("span",[t._v(t._s(e.nickname))]),1==e.userId?s("v-icon",{attrs:{size:"20",color:"#ffa51e"}},[t._v(" mdi-check-decagram ")]):t._e()],1),s("div",{staticClass:"comment-info"},[s("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t.count-i)+"楼")]),s("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("date")(e.createTime)))]),s("span",{class:t.isLike(e.id)+" iconfont icondianzan",on:{click:function(s){return t.like(e)}}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.likeCount>0,expression:"item.likeCount > 0"}]},[t._v(" "+t._s(e.likeCount))]),s("span",{staticClass:"reply-btn",on:{click:function(s){return t.replyComment(i,e)}}},[t._v(" 回复 ")])]),s("p",{staticClass:"comment-content",domProps:{innerHTML:t._s(e.commentContent)}}),t._l(e.replyDTOList,(function(a){return s("div",{key:a.id,staticStyle:{display:"flex"}},[s("v-avatar",{staticClass:"comment-avatar",attrs:{size:"36"}},[s("img",{attrs:{src:a.avatar}})]),s("div",{staticClass:"reply-meta"},[s("div",{staticClass:"comment-user"},[a.webSite?s("a",{attrs:{href:a.webSite,target:"_blank"}},[t._v(" "+t._s(a.nickname)+" ")]):s("span",[t._v(t._s(a.nickname))]),1==a.userId?s("v-icon",{attrs:{size:"20",color:"#ffa51e"}},[t._v(" mdi-check-decagram ")]):t._e()],1),s("div",{staticClass:"comment-info"},[s("span",{staticStyle:{"margin-right":"10px"}},[t._v(" "+t._s(t._f("date")(a.createTime))+" ")]),s("span",{class:t.isLike(a.id)+" iconfont icondianzan",on:{click:function(e){return t.like(a)}}}),s("span",{directives:[{name:"show",rawName:"v-show",value:a.likeCount>0,expression:"reply.likeCount > 0"}]},[t._v(" "+t._s(a.likeCount))]),s("span",{staticClass:"reply-btn",on:{click:function(e){return t.replyComment(i,a)}}},[t._v(" 回复 ")])]),s("p",{staticClass:"comment-content"},[a.replyUserId!=e.userId?[a.replyWebSite?s("a",{staticClass:"comment-nickname ml-1",attrs:{href:a.replyWebSite,target:"_blank"}},[t._v(" @"+t._s(a.replyNickname)+" ")]):s("span",{staticClass:"ml-1"},[t._v(" @"+t._s(a.replyNickname)+" ")]),t._v(" ， ")]:t._e(),s("span",{domProps:{innerHTML:t._s(a.commentContent)}})],2)])],1)})),s("div",{directives:[{name:"show",rawName:"v-show",value:e.replyCount>3,expression:"item.replyCount > 3"}],ref:"check",refInFor:!0,staticClass:"mb-3",staticStyle:{"font-size":"0.75rem",color:"#6d757a"}},[t._v(" 共 "),s("b",[t._v(t._s(e.replyCount))]),t._v(" 条回复， "),s("span",{staticStyle:{color:"#00a1d6",cursor:"pointer"},on:{click:function(s){return t.checkReplies(i,e)}}},[t._v(" 点击查看 ")])]),s("div",{ref:"paging",refInFor:!0,staticClass:"mb-3",staticStyle:{"font-size":"0.75rem",color:"#222",display:"none"}},[s("span",{staticStyle:{"padding-right":"10px"}},[t._v(" 共"+t._s(Math.ceil(e.replyCount/5))+"页 ")]),s("paging",{ref:"page",refInFor:!0,attrs:{totalPage:Math.ceil(e.replyCount/5),index:i,commentId:e.id},on:{changeReplyCurrent:t.changeReplyCurrent}})],1),s("Reply",{ref:"reply",refInFor:!0,attrs:{type:t.type},on:{reloadReply:t.reloadReply}})],2)],1)})),s("div",{staticClass:"load-wrapper"},[t.count>t.commentList.length?s("v-btn",{attrs:{outlined:""},on:{click:t.listComments}},[t._v(" 加载更多... ")]):t._e()],1)],2):s("div",{staticStyle:{padding:"1.25rem","text-align":"center"}},[t._v(" 来发评论吧~ ")])])}),o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment-title"},[s("i",{staticClass:"iconfont iconpinglunzu"}),t._v("评论")])}],r=(s("a9e3"),s("ac1f"),s("5319"),s("1276"),s("498a"),s("2909")),c=s("2f3e"),l=s("bbe0"),m=s("bbe3"),p={components:{Reply:c["a"],Emoji:m["a"],Paging:l["a"]},props:{type:{type:Number}},created:function(){this.listComments()},data:function(){return{reFresh:!0,commentContent:"",chooseEmoji:!1,current:1,commentList:[],count:0,emojiList:this.$store.state.emojiList}},methods:{replyComment:function(t,e){this.$refs.reply.forEach((function(t){t.$el.style.display="none"})),this.$refs.reply[t].commentContent="",this.$refs.reply[t].nickname=e.nickname,this.$refs.reply[t].replyUserId=e.userId,this.$refs.reply[t].parentId=this.commentList[t].id,this.$refs.reply[t].chooseEmoji=!1,this.$refs.reply[t].index=t,this.$refs.reply[t].$el.style.display="block"},addEmoji:function(t){this.commentContent+=t},checkReplies:function(t,e){var s=this;this.axios.get(this.$store.state.apiPrefix+"/api/comments/"+e.id+"/replies",{params:{current:1,size:5}}).then((function(i){var a=i.data;s.$refs.check[t].style.display="none",e.replyDTOList=a.data,Math.ceil(e.replyCount/5)>1&&(s.$refs.paging[t].style.display="flex")}))},changeReplyCurrent:function(t,e,s){var i=this;this.axios.get(this.$store.state.apiPrefix+"/api/comments/"+s+"/replies",{params:{current:t,size:5}}).then((function(t){var s=t.data;i.commentList[e].replyDTOList=s.data}))},listComments:function(){var t=this,e=this.$route.path,s=e.split("/"),i={current:this.current,type:this.type};switch(this.type){case 1:case 3:i.topicId=s[2];break;default:break}this.axios.get(this.$store.state.apiPrefix+"/api/comments",{params:i}).then((function(e){var s,i=e.data;1==t.current?t.commentList=i.data.recordList:(s=t.commentList).push.apply(s,Object(r["a"])(i.data.recordList));t.current++,t.count=i.data.count,t.$emit("getCommentCount",t.count)}))},insertComment:function(){var t=this;if(!this.$store.state.userId)return this.$store.state.loginFlag=!0,!1;if(""==this.commentContent.trim())return this.$toast({type:"error",message:"评论不能为空"}),!1;var e=/\[.+?\]/g;this.commentContent=this.commentContent.replace(e,(function(t){return"<img src= '"+this.emojiList[t]+"' width='22'height='20' style='padding: 0 1px'/>"}));var s=this.$route.path,i=s.split("/"),a={commentContent:this.commentContent,type:this.type};switch(this.type){case 1:case 3:a.topicId=i[2];break;default:break}this.commentContent="",this.axios.post(this.$store.state.apiPrefix+"/api/comments",a).then((function(e){var s=e.data;if(s.flag){t.current=1,t.listComments();var i=t.$store.state.blogInfo.websiteConfig.isCommentReview;i?t.$toast({type:"warnning",message:"评论成功，正在审核中"}):t.$toast({type:"success",message:"评论成功"})}else t.$toast({type:"error",message:s.message})}))},like:function(t){var e=this;if(!this.$store.state.userId)return this.$store.state.loginFlag=!0,!1;this.axios.post(this.$store.state.apiPrefix+"/api/comments/"+t.id+"/like").then((function(s){var i=s.data;i.flag&&(-1!=e.$store.state.commentLikeSet.indexOf(t.id)?e.$set(t,"likeCount",t.likeCount-1):e.$set(t,"likeCount",t.likeCount+1),e.$store.commit("commentLike",t.id))}))},reloadReply:function(t){var e=this;this.axios.get(this.$store.state.apiPrefix+"/api/comments/"+this.commentList[t].id+"/replies",{params:{current:this.$refs.page[t].current}}).then((function(s){var i=s.data;e.commentList[t].replyCount++,e.commentList[t].replyCount>5&&(e.$refs.paging[t].style.display="flex"),e.$refs.check[t].style.display="none",e.$refs.reply[t].$el.style.display="none",e.commentList[t].replyDTOList=i.data}))}},computed:{isLike:function(){return function(t){var e=this.$store.state.commentLikeSet;return-1!=e.indexOf(t)?"like-active":"like"}}},watch:{commentList:function(){var t=this;this.reFresh=!1,this.$nextTick((function(){t.reFresh=!0}))}}},u=p,d=(s("6cf3"),s("2877")),f=s("6544"),v=s.n(f),h=s("8212"),C=s("8336"),k=s("132d"),g=Object(d["a"])(u,n,o,!1,null,"5dc17dd5",null),y=g.exports;v()(g,{VAvatar:h["a"],VBtn:C["a"],VIcon:k["a"]});var _={components:{Comment:y},created:function(){this.getTalkById()},data:function(){return{commentType:3,commentCount:0,talkInfo:{},previewList:[]}},methods:{getTalkById:function(){var t=this;this.axios.get(this.$store.state.apiPrefix+"/api/talks/"+this.$route.params.talkId).then((function(e){var s=e.data;t.talkInfo=s.data,t.previewList=t.talkInfo.imgList}))},getCommentCount:function(t){this.commentCount=t},previewImg:function(t){this.$imagePreview({images:this.previewList,index:this.previewList.indexOf(t)})},like:function(t){var e=this;if(!this.$store.state.userId)return this.$store.state.loginFlag=!0,!1;this.axios.post(this.$store.state.apiPrefix+"/api/talks/"+t.id+"/like").then((function(s){var i=s.data;i.flag&&(-1!=e.$store.state.talkLikeSet.indexOf(t.id)?e.$set(t,"likeCount",t.likeCount-1):e.$set(t,"likeCount",t.likeCount+1),e.$store.commit("talkLike",t.id))}))}},computed:{cover:function(){var t="";return this.$store.state.blogInfo.pageList.forEach((function(e){"talk"==e.pageLabel&&(t=e.pageCover)})),"background: url("+t+") center center / cover no-repeat"},isLike:function(){return function(t){var e=this.$store.state.talkLikeSet;return-1!=e.indexOf(t)?"#eb5055":"#999"}}}},$=_,b=(s("5fb23"),s("b0af")),w=s("62ad"),x=s("adda"),L=s("0fd9"),I=Object(d["a"])($,i,a,!1,null,"465906ae",null);e["default"]=I.exports;v()(I,{VAvatar:h["a"],VCard:b["a"],VCol:w["a"],VIcon:k["a"],VImg:x["a"],VRow:L["a"]})},aaf8:function(t,e,s){},e6d0:function(t,e,s){}}]);